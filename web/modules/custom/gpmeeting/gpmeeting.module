<?php
/**
 * @file
 * Contains gpmeeting.module.
 */

use Drupal\node\NodeInterface;

/**
 * Implements hook_ENTITY_TYPE_presave().
 */
function gpmeeting_node_presave(NodeInterface $node) {
  if ($node->getType() == 'meeting') {
    // We are using field_start_date for views sorting.
    $node->set('field_start_date', $node->field_date_range->value);
  }
}

/**
 * Implements hook_views_data_alter().
 */
function gpmeeting_views_data_alter(&$data)
{
  $data['node_field_data']['previous_meetings_filter'] = [
    'title' => t('Custom Previous Meetings Filter'),
    'filter' => [
      'title' => t('Custom Previous Meetings Filter'),
      'help' => 'Filters meetings that happened before the current date ',
      'field' => 'nid',
      'id' => 'previous_meetings_filter',
    ]
  ];

  $data['node_field_data']['upcoming_meetings_filter'] = [
    'title' => t('Custom Upcoming Meetings Filter'),
    'filter' => [
      'title' => t('Custom Upcoming Meetings Filter'),
      'help' => 'Filters meetings that will happen after the current date ',
      'field' => 'nid',
      'id' => 'upcoming_meetings_filter',
    ]
  ];
}
